<<<<<<< HEAD
pnpm lint-staged
=======
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ðŸ”Ž pre-commit: lint-staged ì‹¤í–‰ ë° ìµœì¢… ì ê²€ ì‹œìž‘"

# 0) ì»¤ë°‹ì— í¬í•¨ëœ íŒŒì¼ ëª©ë¡ (ì¶”ê°€/ë³µì‚¬/ìˆ˜ì •)
STAGED_FILES="$(git diff --name-only --cached --diff-filter=ACMR)"
if [ -z "$STAGED_FILES" ]; then
  echo "â„¹ï¸  ìŠ¤í…Œì´ì§•ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ê±´ë„ˆëœë‹ˆë‹¤."
  exit 0
fi

# 1) ë³€ê²½ íŒŒì¼ë§Œ ìžë™ ìˆ˜ì • (eslint --fix, prettier --write)
if ! pnpm lint-staged; then
  echo
  echo "âŒ lint-staged ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
  echo "   - ìžë™ìˆ˜ì • ë¶ˆê°€í•œ ë¦°íŠ¸ ì—ëŸ¬ê°€ ìžˆì„ ìˆ˜ ìžˆì–´ìš”."
  echo "   - ë¡œì»¬ì—ì„œ 'pnpm lint'ë¡œ ì—ëŸ¬ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•œ ë’¤ ë‹¤ì‹œ ì»¤ë°‹í•˜ì„¸ìš”."
  exit 1
fi

# 2) ìµœì¢… ì ê²€: ìŠ¤í…Œì´ì§•ëœ íŒŒì¼ë§Œ ëŒ€ìƒìœ¼ë¡œ ê²€ì‚¬(ìˆ˜ì • ì—†ì´ ì‹¤íŒ¨ë§Œ ê°ì§€)
PRETTIER_FAIL=0
ESLINT_FAIL=0

# ê°œí–‰ë§Œ êµ¬ë¶„ìžë¡œ ì‚¬ìš© (ê³µë°± í¬í•¨ íŒŒì¼ëª… ì•ˆì „)
IFS="$(printf '\n')"
for f in $STAGED_FILES; do
  case "$f" in
    *.js|*.jsx|*.ts|*.tsx|*.json|*.css|*.md)
      # Prettier í¬ë§· ì¤€ìˆ˜ í™•ì¸ (ìˆ˜ì • ì—†ì´ ê²€ì‚¬)
      pnpm -s prettier --check "$f" || PRETTIER_FAIL=1
      ;;
  esac
done

for f in $STAGED_FILES; do
  case "$f" in
    *.js|*.jsx|*.ts|*.tsx)
      # ESLint ìµœì¢… í™•ì¸ (ìˆ˜ì • ì—†ì´ ê²€ì‚¬)
      pnpm -s eslint --max-warnings=0 "$f" || ESLINT_FAIL=1
      ;;
  esac
done
unset IFS

if [ "$PRETTIER_FAIL" -ne 0 ]; then
  echo
  echo "âŒ Prettier í¬ë§· ìœ„ë°˜ì´ ë‚¨ì•„ ìžˆìŠµë‹ˆë‹¤."
  echo "   - 'pnpm format' í›„ ë‹¤ì‹œ ì»¤ë°‹í•˜ì„¸ìš”."
  exit 1
fi

if [ "$ESLINT_FAIL" -ne 0 ]; then
  echo
  echo "âŒ ESLint ìœ„ë°˜ì´ ë‚¨ì•„ ìžˆìŠµë‹ˆë‹¤."
  echo "   - 'pnpm lint:fix' ë˜ëŠ” ìˆ˜ë™ ìˆ˜ì • í›„ ë‹¤ì‹œ ì»¤ë°‹í•˜ì„¸ìš”."
  exit 1
fi

COUNT="$(printf '%s\n' "$STAGED_FILES" | wc -l | tr -d ' ')"
echo "âœ… pre-commit í†µê³¼: ${COUNT}ê°œ íŒŒì¼ ì ê²€ ì™„ë£Œ"
exit 0
>>>>>>> 382ffc3 (Chore/code style commit convention)
